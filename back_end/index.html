<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>DNS安全检查</title>

    <link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.6/css/bootstrap.min.css" media="screen" title="no title" charset="utf-8">
    <style media="screen">
      .main{
        margin-top: 2em;
      }
      .info-box{
        padding: 0.5em 0.3em;
        border-radius: 0.3em;

      }
    </style>
  </head>
  <body>
    <div class="">

    </div>
    <div class="container main">
      <div class="row">
        <div class="col-md-6 col-md-offset-3">
          <form id="dns-form">
            <div class="input-group">
              <input type="text" class="form-control" name="domain" id="domain" required placeholder="请输入需要查询的域名">
              <span class="input-group-btn" >
                <button class="btn btn-primary" type="submit">点击查询</button>
              </span>
            </div><!-- /input-group -->
          </form>
        </div>
      </div>
      <div class="row">
        <div class="col-md-6 col-md-offset-3">
          <div class="checkbox">
             <label>
               <input type="checkbox"> DNS检查
             </label>
             <label>
               <input type="checkbox">　DNSSec验证
             </label>
           </div>
        </div>
      </div>
    </div>
    <div class="container-fluid main">
      <div class="row">
          <div class="main">
            <div class="col-md-12">
              <div class="alert">
              </div>
            </div>
            <div class="col-md-6 col-sm-12">
              <div class="dns-message well">

              </div>
            </div>
            <div class="col-md-6 col-sm-12 ">
              <div class="dnssec-message well">

              </div>
            </div>
          </div>
      </div>
    </div>
   </div>


    <script src="//cdn.bootcss.com/socket.io/1.4.8/socket.io.js"></script>
    <script src="//cdn.bootcss.com/jquery/2.2.4/jquery.js"></script>
    <script src="https://cdn.bootcss.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <script>
      var socket = io.connect('http://localhost:5000');
      socket.on('domain-message', function(msg){
        $(".alert").empty();
        if(msg.Type&&msg.Type=='start'){
          $('.alert').append($('<p class="info">').text(msg.Message));
        }else{
          $('.alert').append($('<p class="info">').text(msg.Message));
        }
        //
      });
      socket.on('welcome',function(msg){
        $(".alert").empty();
        $('.alert').append($('<p class="info">').text(msg.Message));
      })
      socket.on('message',function(msg){
         var obj=JSON.parse(msg);
         if(obj.type==="message"){
          $(".alert").empty();
          $('.alert').append($('<p class="info">').text(obj.message));
           return
         }
         if(obj.error!==""){
            if(obj.type&&obj.type==="dns"){
                $('.dns-message').append($('<p class="bg-danger info-box">').text(obj.message));
            }else if(obj.type&&obj.type=="dnssec"){
                $('.dnssec-message').append($('<p class="bg-danger info-box">').text(obj.message));
            }
         }else{
           if(obj.type&&obj.type==="dns"){
               $('.dns-message').append($('<p class="bg-info info-box">').text(obj.message));
           }else if(obj.type&&obj.type=="dnssec"){
               $('.dnssec-message').append($('<p class="bg-info info-box">').text(obj.message));
           }
         }
      })
      $('#dns-form').submit(function(){
         if( $('#domain').val() == ""){
           alert("尚未填写需要查询的域名名称!");
           return
         }
         socket.emit('domain', $('#domain').val());
         $('#m').val('');
         $(".dns-message").empty();
         $(".dnssec-message").empty();
         return false;
      });
    </script>
  </body>
</html>
